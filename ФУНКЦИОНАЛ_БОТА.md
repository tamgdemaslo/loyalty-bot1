# 🚗 Telegram-бот системы лояльности автосервиса

## 📋 Обзор системы

Это комплексная система лояльности для автосервиса, реализованная в виде Telegram-бота с интеграцией с системами МойСклад и YClients. Система предоставляет клиентам удобный способ управления бонусным счетом, отслеживания истории обслуживания и планирования технического обслуживания автомобиля.

## 🏗️ Архитектура

### Основные компоненты:
- **Telegram Bot** - основной интерфейс взаимодействия
- **База данных SQLite** - хранение пользовательских данных
- **Интеграция МойСклад** - получение данных об отгрузках и клиентах
- **Интеграция YClients** - система онлайн-записи
- **Web-приложение** (в разработке) - современный веб-интерфейс

## 🎯 Основной функционал

### 1. 🌟 Система лояльности и бонусов

#### Уровни лояльности:
1. **🌱 Новичок** (от 0 руб)
   - 5% бонусов с покупок
   - Списание до 30% от чека
   
2. **🥈 Серебро** (от 15,000 руб)
   - 7% бонусов с покупок
   - Списание до 35% от чека
   - Уведомления о специальных предложениях
   
3. **🥇 Золото** (от 40,000 руб)
   - 10% бонусов с покупок
   - Списание до 40% от чека
   - Приоритетная запись на сервис
   
4. **💎 Платина** (от 100,000 руб)
   - 15% бонусов с покупок
   - Списание до 50% от чека
   - VIP-обслуживание

#### Функции бонусной системы:
- ✅ Автоматическое начисление бонусов после обслуживания
- ✅ Списание бонусов с последнего чека
- ✅ Отслеживание истории операций
- ✅ Уведомления о начислениях и повышении статуса
- ✅ Защита от мошенничества (ограничения на списание)

### 2. 📊 Личный кабинет и профиль

#### Информация о профиле:
- 👤 Личные данные (имя, телефон)
- 💎 Текущий баланс бонусов
- 🏆 Статус лояльности и прогресс
- 📈 Статистика посещений и трат

#### Управление профилем:
- 📞 Просмотр контактной информации
- ⚙️ Настройки уведомлений (в разработке)
- 🚗 Управление автомобилями (в разработке)

### 3. 📈 Аналитика и отчеты

#### Персональная статистика:
- 💰 Общая сумма трат за все время
- 📊 Количество посещений
- 💳 Средний чек
- 🎁 Сэкономленная сумма (списанные бонусы)
- 📅 Даты первого и последнего посещения
- 🔄 Частота посещений

#### Рейтинги:
- 🏆 Позиция среди всех клиентов
- 📊 Процентиль по тратам
- 🔥 Топ-5 клиентов для сравнения

#### История операций:
- 📝 Детальная история начислений и списаний
- 📊 Статистика за текущий месяц
- 📈 Тренды активности

### 4. 🔧 Система технического обслуживания (ТО)

#### Отслеживаемые работы:
1. **🛢️ Замена моторного масла** (каждые 7,000 км / 6 мес)
2. **⚙️ Замена трансмиссионного масла** (каждые 25,000 км / 24 мес)
3. **🔧 Аппаратная замена масла АКПП** (каждые 60,000 км / 36 мес)
4. **🛑 Замена тормозной жидкости** (каждые 40,000 км / 24 мес)
5. **💨 Замена воздушного фильтра** (каждые 7,000 км / 6 мес)
6. **🌬️ Замена салонного фильтра** (каждые 7,000 км / 12 мес)
7. **⛽ Замена топливного фильтра** (каждые 20,000 км / 12 мес)

#### Функции ТО:
- ✅ Автоматическое отслеживание статуса работ
- ✅ Уведомления о приближающихся сроках
- ✅ Ручное добавление выполненных работ
- ✅ История выполнения по каждой работе
- ✅ Интеграция с МойСклад для автоматического учета

#### Статусы работ:
- 🟢 **В порядке** - до следующего ТО далеко
- 🟡 **Скоро** - приближается срок (10% от интервала)
- 🔴 **Просрочено** - пропущен срок
- ⚪ **Никогда не делали** - работа ни разу не выполнялась

### 5. 📅 Система онлайн-записи

#### Возможности записи:
- 🔍 Выбор услуги из каталога
- 👨‍🔧 Выбор специалиста
- 📅 Выбор даты (7 дней вперед)
- ⏰ Выбор времени из свободных слотов
- ✅ Подтверждение записи

#### Интеграция с YClients:
- Получение списка услуг
- Получение списка мастеров
- Проверка свободных слотов
- Создание записи в системе

### 6. 📊 История обслуживания

#### Детали посещений:
- 🧾 Номер и дата чека
- 💰 Сумма обслуживания
- 🚗 Информация об автомобиле (марка, VIN)
- 📍 Пробег при обслуживании
- 🔧 Список выполненных работ
- 💡 Рекомендации мастера

#### Навигация:
- 📋 Список всех посещений
- 🔍 Детальная информация по каждому
- ◀️ Удобная навигация между экранами

### 7. 💬 Система поддержки

#### Разделы поддержки:
- ❓ **Частые вопросы** - ответы на популярные вопросы
- 📞 **Контакты** - информация о сервисе
- 📋 **Руководство** - описание функций бота
- 💡 **Предложения** - возможность оставить отзыв

## 🛠️ Технические особенности

### Безопасность:
- 🔐 Авторизация по номеру телефона
- 🛡️ Защита от повторного начисления бонусов
- ⚠️ Валидация всех пользовательских данных
- 🔒 Ограничения на списание бонусов

### Надежность:
- 🔄 Retry-механизм для API-запросов
- 📝 Подробное логирование операций
- 🚨 Обработка ошибок и исключений
- 💾 Резервное копирование данных

### Производительность:
- ⚡ Кэширование данных
- 📊 Оптимизированные SQL-запросы
- 🔀 Асинхронная обработка уведомлений
- 📱 Быстрый отклик интерфейса

## 🔗 Интеграции

### МойСклад API:
- 👥 Управление контрагентами
- 📦 Получение данных об отгрузках
- 💰 Применение скидок
- 📊 Синхронизация данных

### YClients API:
- 🏢 Управление компанией
- 👨‍🔧 Получение списка сотрудников
- 🛠️ Каталог услуг
- 📅 Система бронирования

### Telegram Bot API:
- 💬 Обмен сообщениями
- ⌨️ Интерактивные клавиатуры
- 🌐 Web App интеграция
- 📲 Push-уведомления

## 🚀 Запуск и использование

### Команды бота:
- `/start` - авторизация и главное меню
- `/app` - открытие веб-приложения

### Главное меню:
- 💎 **Баланс** - просмотр бонусного счета
- 🎁 **Списать баллы** - использование бонусов
- 📊 **История** - посещения и транзакции
- 📈 **Аналитика** - статистика и рейтинги
- 🔧 **ТО** - техническое обслуживание
- 📅 **Записаться** - онлайн-запись
- 👤 **Профиль** - личный кабинет
- 💬 **Поддержка** - помощь и информация

## 📱 Особенности интерфейса

### Современный дизайн:
- 🎨 Премиальные иконки и эмодзи
- 📱 Адаптивные клавиатуры
- 🌟 Интуитивная навигация
- ✨ Красивое форматирование данных

### Удобство использования:
- 🔄 Быстрые переходы между разделами
- 📌 Контекстные подсказки
- ⚡ Мгновенный отклик на действия
- 🎯 Четкая структура информации

## 🔮 Планы развития

### В разработке:
- 🌐 **Веб-приложение** - современный веб-интерфейс
- 🔔 **Настройки уведомлений** - персонализация
- 🚗 **Управление автопарком** - несколько автомобилей
- 📊 **Расширенная аналитика** - больше метрик
- 🎁 **Программы лояльности** - сезонные акции

### Будущие функции:
- 📧 Email-уведомления
- 📱 Мобильное приложение
- 🤖 AI-рекомендации по ТО
- 💳 Интеграция с платежными системами
- 🎮 Геймификация (достижения, челленджи)

---

## 📋 Файловая структура проекта

```
loyalty-bot/
├── run_bot.py              # Точка входа в приложение
├── bot/
│   ├── main.py             # Основной модуль бота
│   ├── handlers.py         # Обработчики команд и сообщений
│   ├── keyboards.py        # Клавиатуры и интерфейс
│   ├── config.py           # Конфигурация и настройки
│   ├── db.py               # База данных и модели
│   ├── loyalty.py          # Система уровней лояльности
│   ├── accrual.py          # Начисление и списание бонусов
│   ├── analytics.py        # Аналитика и отчеты
│   ├── maintenance.py      # Техническое обслуживание
│   ├── moysklad.py         # Интеграция с МойСклад
│   ├── yclients.py         # Интеграция с YClients
│   ├── formatting.py       # Форматирование данных
│   ├── utils.py            # Вспомогательные функции
│   └── exceptions.py       # Обработка исключений
├── admin/                  # Административная панель
├── miniapp/               # Веб-приложение
└── loyalty.db             # База данных SQLite
```

---

*Данный бот представляет собой полнофункциональную систему лояльности для автосервиса с современным интерфейсом, надежной архитектурой и широкими возможностями для клиентов.*
